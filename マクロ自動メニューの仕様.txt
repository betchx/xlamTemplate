マクロ自動メニュー
                                                                   2021/6/5 Atsushi TANABE (@betchx)


◎概要

標準モジュールから実行可能なマクロを抽出し，
リボンのボタンから実行可能とするもの．

すべての登録マクロを実行する大型のボタン「全マクロ」と，
3つのスプリットボタンがリボンのホームタブに追加される．
スプリットボタンは，10のボタンと「その他」サブメニューで構成される．
直近の最大10個までの「その他」から実行されたマクロをボタンから呼び出すことができる．
履歴はそれぞれのスプリットで別となっている．
なお，「全マクロ」からの実行履歴は，全マクロ内部にある最近実行されたメニューからアクセスできる．

全マクロはdynamicMenuで実装されており，
特に指定しない限り，マクロとして実行可能なサブルーチンはすべて自動で登録される．
メニューの構成はトップレベルにモジュール名があり，
その下にもしあればカテゴリーとカテゴリーのないマクロが入る．
カテゴリーサブメニューの下には，そのカテゴリーのマクロが入る．
メニューへの登録にあたって，後述のスペシャルコメントを用いることでカスタマイズが可能．

全マクロの一番下には「メニュー再構築」がある．
VBEでマクロやキーワードをを追加した場合などに選択することで，
最新の内容に更新される．


〇全マクロメニューのツリー構造 

全マクロ --+-- 最近使ったマクロ --+-- Macro8 ※直前に実行したマクロ
           |                      |
           |                      +-- Macro4 ※その前に実行したマクロ
           |                      |
           |                      ．．．     ※最大9項目まで
           |
           +-- Module1 --+-- Macro1
           |             |
           |             +-- Macro2
           |             |
           |             ．．．
           |
           +-- Module2 --+-- Macro6 
           |             |
           |             +-- Macro7
           |             |
           |             +-- Macro8
           |             |
           |             +-- Macro9
           |             |
           |             ．．．
           ...
           |
           +-- メニュー再構築

※ モジュールが一つしかない場合は，内容が展開される．（テンプレートを開いただけのときの状態）



★マクロ用キーワード （スペシャルコメント）
リボンへの登録にあたっての情報をマクロ定義の直前のコメントで設定できる．
設定に用いるキーワードとその説明を以下に示す．
なお，キーワードは行頭から定義すること（行頭に"'"を持ってくること）
キーワードを複数指定した場合は，supertipを除き最後のものが有効．（上書きされる）
supertipは連結される．
キーワードはすべてオプションであり，つけなくてもよい．

' label: str
　ボタンのラベルをマクロ名からstrに変更する．

' screentip: str
　ボタンの上でホバーした時のヒントのタイトル部分をマクロ名からstrに変更する．

' supertip: str
　ボタンの上でホバーした時のヒントの内容説明部分をstrに変更する．
　複数回指定可能．連結される．
　ただし，すべて1行となる．（制限事項）

' hidden: [False|isAddin]
　これが指定されたマクロはメニューに表示されなくなる．
　作業用であったりして公開したくないものに指定する．
　Falseを指定することもでき，この場合は一時的に表示される．
　isAddinの場合，ThisWorkbook.isAddinがTrueの場合は非表示になる．（開発用マクロに設定する使い方を想定）
　TrueやONなど，isAddinとFalse以外であればすべて非表示扱い．(大文字小文字は無視）

' export: [False]
　標準モジュール以外は登録しないのがデフォルトであるが，これが指定された場合は登録を行う．
　Falseを指定することもでき，この場合は一時的に抑制される．
　TrueなどのFalse以外であればすべて登録するものとして扱われる．(大文字小文字は無視）

' target: 型
　型にはChart，Rangeなどを指定する．
　Selectionオブジェクト及びその親の型と一致した場合のみメニューに表示する．
　Like文で比較するので，*などが使用できる．
　たいていの場合，「Chart*」もしくは「Range」で事足りる．
　target:はそのマクロに対して設定
　moduleTarget:とtarget:は併用でき，モジュールはチャートでのみ表示され，
　さらに特定のメニューはチャートの系列が選択されている時のみ表示などと設定も可能．
　（moduleTarge:に「Chart*」，マクロのtarget:に「Series」と設定する．）


〇イメージ（アイコン）関係キーワード
イメージ関係のキーワードには以下の3つがあり，排他である．
すべて省略された場合は，imageMsoの"MacroDefault"が用いられる．

' imageMso: str
　ボタンのイメージを標準のアイコンから指定する．
　拡張されたExcel14のアイコンセットを用いる．

' image: str
　エクセルファイルに追加されたイメージファイルの名前を使用する．
　具体的にはボタンのxmlに image="str" が追加される．
　いわゆるリボンのアイコン設定の標準的な方法．
　あらかじめimageを追加しておく必要がある．
　イメージサイズは適宜スケールされるが，解像度的には32×32が良いらしい．

' externalImage: str
　strにはLoadPicture関数が対応する画像ファイルへの絶対パスを指定する．
　PNGは非対応なので注意．


★モジュール用キーワード
モジュールのどこに記載してあってもよいが，通常はモジュールの先頭部分（Option Explicitの直後）に指定する．

' moduleTarget: 型
　型にはChart，Rangeなどを指定する．
　Selectionオブジェクト及びその親の型と一致した場合のみメニューに表示する．
　Like文で比較するので，*などが使用できる．
　moduleTarget:はモジュール全体を非表示に設定できる．


' moduleImageMso: str
' moduleImage: str
' moduleInternalImage: str
' moduleExternalImage: str



